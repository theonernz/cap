# æ¸è¿›å¼å˜è´¨ç³»ç»Ÿä¼˜åŒ–è¯´æ˜

## é—®é¢˜èƒŒæ™¯

**åŸè®¾è®¡é—®é¢˜**ï¼šæ‰‡è´åœ¨åˆ›å»ºæ—¶å°±æœ‰2%æ¦‚ç‡ç›´æ¥å˜è´¨ï¼Œå¯¼è‡´ï¼š
1. åˆå§‹åŒ–800ä¸ªæ‰‡è´æ—¶ï¼Œçº¦16ä¸ªåŒæ—¶å˜è´¨
2. æ‰¹é‡è¡¥å……æ‰‡è´æ—¶ï¼Œå¤šä¸ªæ‰‡è´åŒæ—¶å˜è´¨
3. 40ç§’åå¤šä¸ªå˜è´¨æ‰‡è´åŒæ—¶æ¶ˆå¤±ï¼Œè§¦å‘æ–°ä¸€è½®æ‰¹é‡å˜è´¨
4. å‡ºç°ä¸è‡ªç„¶çš„"**å˜è´¨æ½®**"ç°è±¡

## ä¼˜åŒ–æ–¹æ¡ˆ

### æ–°æœºåˆ¶ï¼šæ¸è¿›å¼å˜è´¨

æ‰‡è´ä¸å†åœ¨å‡ºç”Ÿæ—¶å°±å˜è´¨ï¼Œè€Œæ˜¯éšç€æ—¶é—´æ¨ç§»é€æ¸å˜è´¨ï¼š

```
æ‰‡è´ç”Ÿå‘½å‘¨æœŸï¼š
0-15ç§’   â†’ æ–°é²œæœŸï¼ˆä¸ä¼šå˜è´¨ï¼‰
15-30ç§’  â†’ é£é™©æœŸï¼ˆå¯èƒ½å˜è´¨ï¼‰
30ç§’+    â†’ æˆç†ŸæœŸï¼ˆä¸å†å˜è´¨ï¼Œä½†å¯èƒ½æˆé•¿ä¸ºKingï¼‰
å˜è´¨å    â†’ 40ç§’åè…çƒ‚æ¶ˆå¤±
```

### å˜è´¨æ¦‚ç‡

**æ—¶é—´çª—å£**ï¼š15-30ç§’ï¼ˆå…±15ç§’çª—å£ï¼‰
**æ£€æŸ¥é¢‘ç‡**ï¼šæ¯5ç§’æ£€æŸ¥ä¸€æ¬¡
**å•æ¬¡æ¦‚ç‡**ï¼š0.5%
**æ€»ä½“æ¦‚ç‡**ï¼šçº¦1.5%ï¼ˆ3æ¬¡æ£€æŸ¥æœºä¼šï¼‰

è®¡ç®—ï¼š
- 15ç§’çª—å£ Ã· 5ç§’/æ¬¡ = 3æ¬¡æ£€æŸ¥
- 1 - (1-0.005)Â³ â‰ˆ 1.49%

## æŠ€æœ¯å®ç°

### 1. åˆ›å»ºæ‰‡è´ï¼ˆ`createScallop`ï¼‰

```javascript
const scallop = {
    // ...å…¶ä»–å±æ€§
    isSpoiled: false,           // æ–°æ‰‡è´ä¸å˜è´¨
    spoiledTime: null,
    spoilCheckTime: null        // è®°å½•ä¸Šæ¬¡æ£€æŸ¥æ—¶é—´
};
```

### 2. æ¸è¿›å¼æ£€æŸ¥ï¼ˆ`cleanupSpoiledScallops`ï¼‰

```javascript
// æ£€æŸ¥15-30ç§’çš„æ­£å¸¸æ‰‡è´
if (!scallop.isSpoiled && age >= 15000 && age <= 30000) {
    const timeSinceLastCheck = now - (scallop.spoilCheckTime || 0);
    
    // è·ç¦»ä¸Šæ¬¡æ£€æŸ¥è¶…è¿‡5ç§’
    if (timeSinceLastCheck >= 5000) {
        scallop.spoilCheckTime = now;
        
        // 0.5%æ¦‚ç‡å˜è´¨
        if (Math.random() < 0.005) {
            this.makeSpoiled(scallop);
        }
    }
}
```

### 3. ç»Ÿä¸€å˜è´¨å¤„ç†ï¼ˆ`makeSpoiled`ï¼‰

```javascript
makeSpoiled(scallop) {
    scallop.isSpoiled = true;
    scallop.spoiledTime = Date.now();
    scallop.color = '#696969';          // æ·±ç°è‰²
    scallop.innerColor = '#2F4F2F';     // æš—ç»¿è‰²
    scallop.powerValue *= -10;          // è´Ÿèƒ½åŠ›å€¼
}
```

## æ•ˆæœå¯¹æ¯”

### ä¼˜åŒ–å‰ï¼ˆæ‰¹é‡å˜è´¨ï¼‰

```
æ—¶é—´è½´ï¼š
0s:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 16ä¸ªæ‰‡è´åŒæ—¶å˜è´¨ âŒ
40s: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 16ä¸ªåŒæ—¶æ¶ˆå¤±
41s: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ æ–°ç”Ÿæˆçš„åˆæœ‰å˜è´¨ âŒ
```

### ä¼˜åŒ–åï¼ˆæ¸è¿›å˜è´¨ï¼‰

```
æ—¶é—´è½´ï¼š
0s:   ................  æ‰€æœ‰æ‰‡è´æ–°é²œ âœ…
15s:  â–ˆ...............  1ä¸ªå¼€å§‹å˜è´¨
20s:  â–ˆâ–ˆ..............  2ä¸ª
25s:  â–ˆâ–ˆâ–ˆ.............  3ä¸ª
30s:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ...........  5ä¸ª
35s:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ..........  6ä¸ª
40s:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ.........  7ä¸ªï¼ˆæ—§çš„å¼€å§‹æ¶ˆå¤±ï¼‰
45s:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ.........  å¹³ç¨³çŠ¶æ€ âœ…
```

## é…ç½®å‚æ•°

ä½ç½®ï¼š`server/config.js`

```javascript
spoiledScallop: {
    enabled: true,
    maxPercentage: 0.025,       // æœ€å¤š2.5%
    lifetime: 40000,            // 40ç§’æ¶ˆå¤±
    powerMultiplier: -10,       // -10å€æƒ©ç½š
    
    // æ¸è¿›å˜è´¨è®¾ç½®ï¼ˆç¡¬ç¼–ç ï¼‰
    // minAgeForSpoiling: 15000     // 15ç§’å¼€å§‹é£é™©
    // maxAgeForSpoiling: 30000     // 30ç§’ç»“æŸé£é™©
    // spoilCheckInterval: 5000     // 5ç§’æ£€æŸ¥ä¸€æ¬¡
    // spoilChancePerCheck: 0.005   // 0.5%å•æ¬¡æ¦‚ç‡
}
```

## ä¼˜åŠ¿æ€»ç»“

âœ… **æ›´è‡ªç„¶**ï¼šæ‰‡è´é€ä¸ªå˜è´¨ï¼Œè€Œéæ‰¹é‡å‡ºç°
âœ… **æ›´å¹³è¡¡**ï¼šå˜è´¨æ‰‡è´æ•°é‡å¹³ç¨³å¢é•¿ï¼Œæ— æ³¢åŠ¨
âœ… **æ›´çœŸå®**ï¼šç¬¦åˆé£Ÿç‰©è…è´¥çš„æ¸è¿›è¿‡ç¨‹
âœ… **æ›´å‹å¥½**ï¼šç©å®¶ä¸ä¼šçªç„¶é‡åˆ°å¤§é‡å˜è´¨æ‰‡è´

## è§‚å¯Ÿå»ºè®®

å¯åŠ¨æœåŠ¡å™¨åï¼š
1. **0-15ç§’**ï¼šæ‰€æœ‰æ‰‡è´æ­£å¸¸ï¼Œæ— å˜è´¨
2. **15-30ç§’**ï¼šå¼€å§‹çœ‹åˆ°é›¶æ˜Ÿå˜è´¨
3. **30ç§’+**ï¼šå˜è´¨æ‰‡è´æ•°é‡ç¨³å®šåœ¨çº¦1.5%
4. **40ç§’+**ï¼šæ—§çš„å˜è´¨æ‰‡è´å¼€å§‹æ¶ˆå¤±

æ§åˆ¶å°æ—¥å¿—ï¼š
```
ğŸ¦  1 scallop(s) spoiled naturally (gradual spoiling)
ğŸ¦  2 scallop(s) spoiled naturally (gradual spoiling)
ğŸ—‘ï¸ Removed 1 decayed spoiled scallops (40s lifetime)
```

---

**ç‰ˆæœ¬**: v1.12 (ä¼˜åŒ–ç‰ˆ)  
**æ—¥æœŸ**: 2025-12-29  
**æ”¹è¿›**: ä»æ‰¹é‡å˜è´¨æ”¹ä¸ºæ¸è¿›å¼å˜è´¨
